{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar react_1 = require(\"react\");\n\nvar common_1 = require(\"./common\");\n\nvar FORCE_STATE_ACTION = '__FORCE_STATE_INTERNAL_API__';\n\nfunction isForceStateAction(action) {\n  return typeof action === 'object' && action !== null && 'type' in action && action.type === FORCE_STATE_ACTION;\n}\n\nfunction addForceStateActionToReducer(reducer) {\n  return function (state, action) {\n    if (isForceStateAction(action)) return action.payload;\n    return reducer(state, action);\n  };\n}\n\nfunction useStorageReducer(storage, key, reducer, defaultInitialArg, defaultInit) {\n  if (defaultInit === void 0) {\n    defaultInit = function (x) {\n      return x;\n    };\n  }\n\n  var defaultState = defaultInit(defaultInitialArg);\n\n  var _a = react_1.useReducer(addForceStateActionToReducer(reducer), common_1.useInitialState(storage, key, defaultState)),\n      state = _a[0],\n      dispatch = _a[1];\n\n  common_1.useStorageListener(storage, key, defaultState, function (newValue) {\n    dispatch({\n      type: FORCE_STATE_ACTION,\n      payload: newValue\n    });\n  });\n  var writeError = common_1.useStorageWriter(storage, key, state);\n  return [state, dispatch, writeError];\n}\n\nexports.default = useStorageReducer;","map":{"version":3,"sources":["../src/reducer.ts"],"names":[],"mappings":";;;;;;AAAA,IAAA,OAAA,GAAA,OAAA,CAAA,OAAA,CAAA;;AAEA,IAAA,QAAA,GAAA,OAAA,CAAA,UAAA,CAAA;;AAOA,IAAM,kBAAkB,GAAG,8BAA3B;;AAGA,SAAS,kBAAT,CACE,MADF,EACiC;AAE/B,SACE,OAAO,MAAP,KAAkB,QAAlB,IACA,MAAM,KAAK,IADX,IAEA,UAAU,MAFV,IAGA,MAAM,CAAC,IAAP,KAAgB,kBAJlB;AAMD;;AAED,SAAS,4BAAT,CAA4C,OAA5C,EAAkE;AAChE,SAAO,UAAC,KAAD,EAAW,MAAX,EAA0C;AAC/C,QAAI,kBAAkB,CAAC,MAAD,CAAtB,EAAgC,OAAO,MAAM,CAAC,OAAd;AAChC,WAAO,OAAO,CAAC,KAAD,EAAQ,MAAR,CAAd;AACD,GAHD;AAID;;AAiBD,SAAS,iBAAT,CACE,OADF,EAEE,GAFF,EAGE,OAHF,EAIE,iBAJF,EAKE,WALF,EAK8D;AAA5D,MAAA,WAAA,KAAA,KAAA,CAAA,EAAA;AAAA,IAAA,WAAA,GAAA,UAAgD,CAAhD,EAAiD;AAAK,aAAA,CAAA;AAAM,KAA5D;AAA4D;;AAE5D,MAAM,YAAY,GAAG,WAAW,CAAC,iBAAD,CAAhC;;AAEM,MAAA,EAAA,GAAA,OAAA,CAAA,UAAA,CAAA,4BAAA,CAAA,OAAA,CAAA,EAAA,QAAA,CAAA,eAAA,CAAA,OAAA,EAAA,GAAA,EAAA,YAAA,CAAA,CAAA;AAAA,MAAC,KAAA,GAAA,EAAA,CAAA,CAAA,CAAD;AAAA,MAAQ,QAAA,GAAA,EAAA,CAAA,CAAA,CAAR;;AAKN,EAAA,QAAA,CAAA,kBAAA,CAAmB,OAAnB,EAA4B,GAA5B,EAAiC,YAAjC,EAA+C,UAAC,QAAD,EAAY;AACzD,IAAA,QAAQ,CAAC;AAAE,MAAA,IAAI,EAAE,kBAAR;AAA4B,MAAA,OAAO,EAAE;AAArC,KAAD,CAAR;AACD,GAFD;AAGA,MAAM,UAAU,GAAG,QAAA,CAAA,gBAAA,CAAiB,OAAjB,EAA0B,GAA1B,EAA+B,KAA/B,CAAnB;AAEA,SAAO,CAAC,KAAD,EAAQ,QAAR,EAAkB,UAAlB,CAAP;AACD;;AAED,OAAA,CAAA,OAAA,GAAe,iBAAf","sourceRoot":"","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar react_1 = require(\"react\");\nvar common_1 = require(\"./common\");\nvar FORCE_STATE_ACTION = '__FORCE_STATE_INTERNAL_API__';\nfunction isForceStateAction(action) {\n    return (typeof action === 'object' &&\n        action !== null &&\n        'type' in action &&\n        action.type === FORCE_STATE_ACTION);\n}\nfunction addForceStateActionToReducer(reducer) {\n    return function (state, action) {\n        if (isForceStateAction(action))\n            return action.payload;\n        return reducer(state, action);\n    };\n}\nfunction useStorageReducer(storage, key, reducer, defaultInitialArg, defaultInit) {\n    if (defaultInit === void 0) { defaultInit = function (x) { return x; }; }\n    var defaultState = defaultInit(defaultInitialArg);\n    var _a = react_1.useReducer(addForceStateActionToReducer(reducer), common_1.useInitialState(storage, key, defaultState)), state = _a[0], dispatch = _a[1];\n    common_1.useStorageListener(storage, key, defaultState, function (newValue) {\n        dispatch({ type: FORCE_STATE_ACTION, payload: newValue });\n    });\n    var writeError = common_1.useStorageWriter(storage, key, state);\n    return [state, dispatch, writeError];\n}\nexports.default = useStorageReducer;\n//# sourceMappingURL=reducer.js.map"]},"metadata":{},"sourceType":"script"}